### 1. 痛点与动机

- 
- **痛点**：
  - 
  - 用户无法直观了解当前视频库占用了多少磁盘空间。
  - 核心路径（如待删除、截图导出）配置在 JSON 中，用户在软件内无法快速确认当前路径指向何处。
  - 硬编码的快捷键可能与用户的其他软件冲突，或不符合个人的操作习惯。
- **动机**：
  - 
  - 提供一个统一的**信息面板**，对视频资产规模进行统计。
  - 提供**路径只读预览**，确保用户知道文件流转的目的地，同时避免运行时修改路径导致的文件丢失风险。
  - 实现**自定义快捷键**系统，赋予用户完全的控制权，并内置智能冲突检测以保证系统稳定性。

### 2. 功能概要

- 
- **独立界面**：通过主界面按钮或菜单呼出，通常为模态窗口。
- **三大模块**：
  - 
  - **资产统计**：显示视频总大小。
  - **路径概览**：只读显示四个关键配置路径。
  - **快捷键配置**：支持录入、修改及冲突检测。
- **安全保存**：修改快捷键后，必须通过冲突检测才能写入配置文件。

### 3. 模块详解

#### 3.1 视频资产统计 (Storage Statistics)

- 
- **显示内容**：当前软件已加载/已索引的所有视频文件的**累计磁盘总大小**。
- **格式**：自动格式化为易读单位（GB, TB）。例如：Total Size: 1.45 TB。
- **计算时机**：
  - 
  - 软件启动扫描时。
  - 执行 **F5 刷新** 后。
  - 执行裁剪或删除操作后（动态扣减）。

#### 3.2 路径配置概览 (Path Configuration - Read Only)

- 
- **交互属性**：**只读（Read-Only）**。
  - 
  - 用户不可在此界面修改路径（修改需编辑 setting.json 或在首次启动配置页进行）。
  - **辅助功能**：每个路径旁提供一个 **“打开文件夹”** 的图标按钮，点击直接呼出资源管理器。
- **展示的四个核心路径**：
  1. 
  2. **待删除目录** (pending_delete_path)：软删除文件的暂存地。
  3. **已处理/已编辑目录** (processed_path)：裁剪源文件的归档地。
  4. **截图导出目录** (screenshot_export_path)：Alt+E 导出的目标地。
  5. **默认截图/数据目录** (data_path 或 video_source)：存放生成的封面、WebP 截图及视频源的根目录。

#### 3.3 快捷键设置 (Shortcut Customization)

- 
- **UI 布局**：两列布局。
  - 
  - 左侧：**功能名称**（如“播放/暂停”、“截图”、“步进”、“旋转”）。
  - 右侧：**输入框**（显示当前键位，点击可录入新键）。
- **支持配置的动作**：
  - 
  - 播放/暂停 (Space)
  - 截图 (E)
  - 导出截图 (Alt + E)
  - 旋转视频 (K)
  - 裁剪分割 (Q)
  - 裁剪合并 (Delete)
  - 步进 - 前进 (D)
  - 步进 - 后退 (A)
  - 软删除 (Ctrl + Delete)
  - 刷新 (F5)
  - *注：部分系统级组合键可能被保留，不可设置。*

### 4. 冲突检测与保存逻辑

为了防止键位冲突导致功能失效，系统在“保存”环节执行严格的校验。

#### 4.1 校验流程

1. 
2. 用户点击 **“保存 (Save)”** 按钮。
3. **遍历检查**：系统比对所有功能绑定的键值组合。
4. **冲突判定**：
   - 
   - **情况 A：无冲突**
     - 
     - 将新的快捷键映射表写入 setting.json。
     - 立即更新内存中的快捷键监听器（无需重启软件）。
     - 关闭设置界面，提示“设置已保存”。
   - **情况 B：发现冲突**
     - 
     - **阻断保存**：不写入文件，设置界面不关闭。
     - **视觉提示**：
       - 
       - 弹出 Toast 或红字提示：“快捷键冲突：[功能A] 与 [功能B] 重复”。
       - 高亮显示冲突的输入框（例如标红）。
5. **强制性**：用户必须解决冲突（修改或恢复默认）才能成功保存。

### 5. Setting 配置与数据存储

- 

- **setting.json**：

  - 
  - **Key Mapping**：建议新增一个 key_bindings 对象，存储所有动作的键码。

  codeJSON

  

  ```
  "key_bindings": {
    "toggle_play": "Space",
    "screenshot": "E",
    "rotate": "K",
    "soft_delete": "Ctrl+Delete",
    ...
  }
  ```

  - 
  - **Fallback**：如果 JSON 中缺少某个键位的配置，软件应加载默认的硬编码快捷键。

### 6. 界面交互流程图

codeMermaid



```
graph TD
    A[进入设置界面] --> B[加载当前配置]
    B --> C{用户操作}
    
    C -- 查看统计 --> D[显示 Total Size]
    C -- 查看路径 --> E[只读显示路径]
    E --> F[点击打开文件夹]
    
    C -- 修改快捷键 --> G[录入新键位]
    G --> H[点击保存]
    
    H --> I{检测冲突?}
    I -- 有冲突 --> J[高亮冲突项 + 报错提示]
    J --> G
    
    I -- 无冲突 --> K[写入 setting.json]
    K --> L[重载快捷键监听]
    L --> M[关闭界面 + Toast 成功]
```