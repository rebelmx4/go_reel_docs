### 1. 痛点与动机

- 
- **痛点**：
  - 
  - 用户记得视频中的画面但难以提取。
  - 需要保存重要画面用于后续参考或封面设置。
  - 从竖屏视频中提取的截图，若直接导出到横屏设备查看，方向可能不正确，需要预处理。
- **动机**：提供快捷、高质量的源分辨率图像获取方式，并允许用户针对图片输出进行独立的旋转设置，不影响视频观看本身的旋转。

### 2. 用户可用功能

- 
- **源分辨率截图**：对当前播放进度的时间点，截取视频原始分辨率的图像。
- **截图旋转设置**：独立于视频播放画面的旋转设置，专门定义截图生成时的旋转角度（0°, 90°, 180°, 270°）。
- **截图自动归档**：截图后自动按视频哈希值归档，并立即显示在**截图轨道**上供预览和管理。

### 3. 相关的 Setting 配置与数据存储

- 
- **存储路径**：Data/screenshot/[文件Hash]/。
- **文件名命名规则**：i_[当前进度的毫秒整数].png (或者是图片格式后缀)。
- **元数据记录**：
  - 
  - 截图旋转的角度配置会写入视频的元数据（跟随视频文件），即使重启软件也能记住该视频的截图输出方向。
- **数据维护**：
  - 
  - 若视频被裁剪（Clip功能），导致文件Hash变化，系统会自动修改对应的截图文件夹名称以匹配新Hash。

### 4. 相关快捷键

- 
- **执行截图**：e
  - 
  - 按下即截取当前帧，无确认弹窗。

### 5. UI 按钮

- 
- **截图按钮**：**无**（完全依赖快捷键 e 操作）。
- **截图旋转按钮**：
  - 
  - **位置**：位于**视频旋转按钮**的后面（视频进度条 -> 视频旋转 -> 截图旋转）。
  - **样式**：显示当前旋转角度数字（0, 90, 180, 270）。

### 6. 用户操作、内部逻辑、UI 变化、数据变化













| 场景         | 用户操作                                                     | 内部逻辑                                                     | UI 变化                                                      | 数据变化                                            |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | --------------------------------------------------- |
| **截图**     | 按下快捷键 e                                                 | 1. 获取当前视频源分辨率帧。<br>2. 读取“截图旋转”设定的角度进行处理。<br>3. 写入文件到 Data/screenshot/[Hash]/。<br>4. 通知截图轨道更新。 | 1. **截图轨道**上新增一张缩略图。<br>2. 若该截图被选中，轨道中间显示该截图。 | 磁盘对应目录下新增图片文件。                        |
| **设置旋转** | 单击“截图旋转按钮”                                           | 1. 将截图旋转角度重置为 0。                                  | 按钮上的数字更新为 0。                                       | 元数据中该视频的 screenshot_rotation 字段更新为 0。 |
| **旋转循环** | *(文档未明确指定增加角度的快捷键，仅提及点击重置，但逻辑上暗示应有增加角度的方式，通常类比视频旋转)* | *(基于文档仅明确了重置逻辑)*                                 | 按钮数字变化 (0->90->180->270)。                             | 元数据更新。                                        |
| **裁剪联动** | 执行视频裁剪                                                 | 1. 裁剪成功后计算新视频 Hash。<br>2. 寻找旧 Hash 对应的截图文件夹。<br>3. 重命名文件夹为新 Hash。 | 无直接UI变化。                                               | Data/screenshot/ 下的文件夹名变更。                 |

### 7. 默认状态下 UI 文字描述

- 
- **截图旋转按钮**：
  - 
  - 默认显示数字 **0**。
  - 位于播放控制区，在视频旋转按钮（功能是旋转观看画面）之后，紧邻步进控制或轨道区域之前。
- **截图反馈**：
  - 
  - 用户截图后，反馈主要体现在下方的**截图轨道**上，该轨道会实时增加新的截图缩略图。







缺少 导出，轨道截图显示 在