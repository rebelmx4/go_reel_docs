
这是对 **跳帧播放 (Skip Frame Playback)** 功能的详细总结：

### 1. 痛点与动机

- **痛点**：面对大量或超长的视频素材，用户无法花费大量时间完整观看每一个视频来确认内容质量或细节。
- **动机**：提供一种“快速预览”机制（类似幻灯片式播放）。通过算法自动提取视频中的关键时间点进行短暂播放，使用户能在短时间内掌握视频的整体概况，提高筛选和审核效率。

### 2. 功能

- 
- **核心机制**：将视频时长根据配置规则划分为 n 个等间隔的时间点。播放器只播放这些时间点处的画面。
- **播放行为**：在每个时间点，视频正常播放指定的时长（例如 2秒，可配置），然后直接跳转到下一个时间点。
- **特殊规则（短视频）**：如果配置中某个时长区间的段数为 0，则该区间内的视频不进行跳帧，直接从头到尾正常播放。
- **持久化与切换**：模式的选择（正常 vs 跳帧）是全局有效的，会记录在配置文件中，重启软件后保留上次的选择。
- **中途切换逻辑**：如果在视频播放中途开启该模式，算法依然基于**视频总时长**计算分段点，但播放器会从**当前进度**开始，执行后续的跳跃播放流程。

### 3. 相关的 setting 配置

所有配置均位于 data/setting.json 文件中。

- 
- **skip_frame_settings (规则配置)**:
  - hold_time_sec: (Int) 跳帧模式下，每个时间点停留播放的秒数（默认 2）。
  - rules: (Object) 视频时长与分段数的映射规则。
    - **Key 解析逻辑**: 1分钟以内用 s (如 "30s")，1分钟以上用 m (如 "120m")。程序需将 Key 解析为统一时间单位并从小到大排序。
    - **匹配逻辑**: 遍历排序后的 Key，找到**第一个大于或等于**当前视频时长的 Key，其对应的 Value 即为分段数 (n)。
- **playback_state (状态记录)**:
  - play_type: (String) 记录当前的播放模式。
    - "normal": 正常播放。
    - "skip": 跳帧播放。

### 4. 相关快捷键和 UI 

- **快捷键**：无（纯鼠标操作）。
- **UI 按钮**：
  - **类型**：Icon 按钮（图标切换）。
  - **位置**：位于 **播放模式按钮**（随机/最近优先）的后面，**步进速率按钮**的前面。
- **图标状态**：
  - **正常模式 (normal)**：显示一个 **向右指的箭头**（代表连续播放）。
  - **跳帧模式 (skip)**：显示 **三条等距离的竖线**（代表切片/断续）。

### 5. 用户操作、内部逻辑、UI 变化、数据变化

| 阶段         | 描述                                                         |
| ------------ | ------------------------------------------------------------ |
| **用户操作** | 用户点击“模式切换按钮”。                                     |
| **UI 变化**  | 按钮图标在“向右箭头”和“三条竖线”之间切换。                   |
| **内部逻辑** | 1.  **读取状态**：获取内存中的 play_type 并取反。 <br> 2. **计算分段**：根据当前视频总时长，匹配 rules 找到对应的分段数 n。<br> 3. **执行播放**：<br> - 若 n=0 或模式为 normal：执行正常线性播放。<br> - 若 n>0 且模式为 skip：计算 n 个时间点，控制播放器在每个点播放 hold_time_sec 秒后跳转至下一点。 |
| **数据变化** | 修改内存中的状态，并将新的模式值（normal 或 skip）写入 data/setting.json 中的 playback_state.play_type 字段 |

### 6. 默认状态下 UI 文字描述

**布局位置**：
播放控制栏位于视频视口的下方。从左至右的顺序中，本功能按钮位于**播放进度条**的右侧区域。具体顺序为：

1. 视频进度条
2. 播放模式按钮（随机/优先）
3. **[跳帧/正常切换按钮]** (本功能)
4. 步进速率按钮
5. 音量控制条